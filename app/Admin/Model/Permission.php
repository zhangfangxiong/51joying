<?phpclass Admin_Model_Permission extends Admin_Model_Base{    const TABLE_NAME = 't_permission';        const PK_FIELD = 'iPermissionID';    /**     * 取一个项目的所有权限点     *      * @return array     */    public static function getAllPermissions ()    {        $aRet = array();        $aList = self::getAll(array());        foreach ($aList as $v) {            $aRet[$v['iMenuID']][] = $v;        }                return $aRet;    }    /**     * 取得用户所有菜单的权限     *      * @param array $aUser                 * @return array     */    public static function getMenuPermissions ($iAdminID)    {        $aUser = Admin_Model_Admin::getDetail($iAdminID);        if ($aUser['sRoleID'] === '-1') {            return - 1;        }        $aRoleList = Admin_Model_Role::getPKIDList($aUser['sRoleID']);        $aModuleID = array();        foreach ($aRoleList as $aRole) {            if (! empty($aRole['sModule'])) {                $aModuleID = array_merge($aModuleID, explode(',', $aRole['sModule']));            }        }        return array_flip($aModuleID);    }    /**     * 取得用户所有访问权限     *      * @param array $aUser                 * @return array     */    public static function getUserPermissions ($iAdminID)    {        $aUser = Admin_Model_Admin::getDetail($iAdminID);        if ($aUser['sRoleID'] === '-1') {            return - 1;        }        $aRoleList = Admin_Model_Role::getPKIDList($aUser['sRoleID']);        $aPermissionID = array();        foreach ($aRoleList as $aRole) {            if (! empty($aRole['sPermission'])) {                $aPermissionID = array_merge($aPermissionID, explode(',', $aRole['sPermission']));            }        }        $aPermission = array();        $aList = self::getPKIDList($aPermissionID, true);        foreach ($aList as $v) {            $aPermission[$v['sPath']] = 1;        }        return $aPermission;    }}